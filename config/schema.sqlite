create table lists (
   id integer primary key,
   name char(16) not null unique,
   description blob,
   created datetime not null default CURRENT_TIMESTAMP
  );

CREATE TABLE subscriptions
(
  id integer PRIMARY KEY,
  subscriber_id integer NOT NULL,
  list_id integer NOT NULL,
  options blob,
  char(1) mode not null default 'M',
  created datetime NOT NULL default CURRENT_TIMESTAMP
);

CREATE TABLE subscribers
(
  id integer PRIMARY KEY,
  email varchar(320) not null unique,
  name varchar(320),
  password varchar(24),
  int bounces,
  created datetime NOT NULL default CURRENT_TIMESTAMP
);

CREATE TABLE confirmations
(
  id int(11) PRIMARY KEY,
  confid varchar(25) not null unique,
  list varchar(16) not null,
  string conftype varchar(16) not null,
  email varchar(320) not null,
  options blob,
  queued datetime NOT NULL default CURRENT_TIMESTAMP
);

CREATE TABLE outbound_messages
(
  id integer PRIMARY KEY,
  envelope_to varchar(320) not null,
  envelope_from varchar(320) not null,
  in_progress int NOT NULL default 0,
  content MEDIUMBLOB,
  queued timestamp NOT NULL default CURRENT_TIMESTAMP,
  last_attempt timestamp NOT NULL default CURRENT_TIMESTAMP
);

CREATE TABLE archived_messages
(
  id int(11) NOT NULL PRIMARY KEY,
  list_id int(11) not null,
  envelope_from varchar(320) not null,
  subject varchar(120),
  messageid varchar(120) not null,
  referenceid varchar(120),
  digested int(1) not null default 0,
  content MEDIUMBLOB,
  archived timestamp NOT NULL default CURRENT_TIMESTAMP
);


CREATE TABLE preferences (
  id integer PRIMARY KEY,
  name char(64) NOT NULL default '',
  description char(255) NOT NULL default '',
  type int(1) NOT NULL default 0,
  value char(64) NOT NULL default '',
);
